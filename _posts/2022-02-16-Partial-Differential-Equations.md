---
layout: post
title: 数学物理方程 1.0
categories: BS-NJU-Course-Review-Physics
description: 对于数学物理方法的回顾
keywords: mathematical physics
mathjax: true
---

> 数学物理方程主要是指物理学的一个分支——数学物理所涉及的**偏微分方程**，有时也包括相关的积分方程、微分积分方程。

注意：本课程教授一些特殊**偏微分方程**的严格求解方法，当然，不是所有偏微分方程都能严格求解，数值解法详见计算物理**以后会有链接**。

| 学习时间                  | 大二下                                                                                 |
| 周课时                      | 4                                                                                          |
| 本人成绩                  | 91                                                                                        |
| 课程教材                  | 梁昆淼 《数学物理方法（第四版）》科学出版社 2010 |
| 个人建议参考教材   | 同上 可参考顾樵《数学物理方程》                                  |
| 先修课程                  | 微积分                                                                                 |

## 数学物理定解问题

[数学物理方程怎么那么难？ - 金白石的回答 - 知乎](https://www.zhihu.com/question/312751640/answer/1911660584)。配图简直笑死我。

###  数学物理方程的导出

| 物理问题                            | 所用物理规律                                            | 数理方程类型                |
| [均匀弦的微小振动](https://shi200005.github.io/2022/02/23/Classical-Mechanics/#%E4%B8%80%E7%BB%B4%E6%B3%A2)             | 牛顿第二定律                                            | 波动方程（双曲型）    |
| 均匀杆的纵振动                 | 牛顿第二定律                                            | 波动方程（双曲型）    |
| 传输线方程（电报方程） | 电路定律                                                    | 波动方程（双曲型）    |
| 均匀薄膜的微小横振动     | 牛顿第二定律                                            | 波动方程（双曲型）    |
| 流体力学与声学方程         | 绝热过程物态方程等                                 | 波动方程（双曲型）   |
| [电磁波方程](https://shi200005.github.io/2022/03/29/Electromagnetism/)                        | 麦克斯韦方程组                                         | 波动方程（双曲型）   |
| [扩散方程](https://shi200005.github.io/2022/02/24/Thermodynamics/#%E8%BE%93%E8%BF%90)                            | 菲克定律                                                    | 输运方程（抛物型）    |
| [热传导方程](https://shi200005.github.io/2022/02/24/Thermodynamics/#%E8%BE%93%E8%BF%90)                        | 傅里叶定律                                                 | 输运方程（抛物型）    |
| 稳定浓度分布                    | 泊松方程\拉普拉斯方程                            | 稳定场方程（椭圆形） |
| [静电场](https://shi200005.github.io/2022/03/29/Electromagnetism/)                                | 静电场方程（泊松方程\拉普拉斯方程） | 稳定场方程（椭圆形） |

在 [Mathematical Tripos: Part II Waves](http://www.damtp.cam.ac.uk/user/sjc1/teaching/Waves/notes.pdf) 这份讲义中，从物理规律介绍了一些关于连续弹性介质中的波动规律。总的来说，我们可以列出普遍物理规律（e.g., 能量守恒、动量守恒......），再结合具体介质响应的力学规律，导出波动方程。我们研究的形式简单对称的波动方程，通常来自一些较为特殊的限制。例如讲义中 Eq.(1.11) 就是结合理想气体状态方程导出的声波波动方程，Eq.(3.20) 就是结合弹性固体应力规律解出的线性弹性波动方程。

### 定解条件

初始条件（给出整个系统的初始状态）、边界条件（常见的三类线性边界条件，非线性的就算了）、衔接条件（泛定方程在衔接点没意义，将对象分成不同部分考虑）。

###   数学物理方程的分类
抱歉暂时没觉得这节有什么用。值得注意的是上面讨论的都是实方程，对于量子力学的薛定谔方程，由于有虚数存在，虽是抛物型，却是波动方程。

### 达朗贝尔公式 定解问题
求解常微分方程的方法是先求出通解再带入初始条件。[一维波动方程](https://shi200005.github.io/2022/02/23/Classical-Mechanics/#%E4%B8%80%E7%BB%B4%E6%B3%A2)可以仿照求解常微分方程的方法，

$$\displaystyle (\frac{\partial^2}{\partial t^2}-a^2\frac{\partial^2}{\partial x^2})u=0$$ -> $$\displaystyle (\frac{\partial}{\partial t}+a\frac{\partial}{\partial x})(\frac{\partial}{\partial t}-a\frac{\partial}{\partial x})u=0$$

求出通解：沿着正负方向行波之和（[光学](https://shi200005.github.io/2022/02/25/Optics/)中已经解释过，$$f_1(x-at)$$ 沿负方向，$$f_2(x+at)$$ 沿正方向），

$$u=f_1(x+at)+f_2(x-at)$$

然后再带入初始条件 $$u\vert_{t=0}=\varphi(x), u_t\vert_{t=0}=\psi(x). (-\infty<x<\infty)$$ 

得到 $$\displaystyle u(x,t)=\frac{1}{2}[\varphi(x+at)+\varphi(x-at)]+\frac{1}{2a}\int_{x-at}^{x+at}\psi(\xi)d\xi$$

这就是**达朗贝尔公式**。但这只是个特例。

无限长和半无限长弦振动的行波求解。还讲了半无限长弦振动问题中反射波是否有**半波损失**的问题。端点固定，奇函数，有半波损失；端点自由，偶函数，无半波损失。

从数学的角度来说，不可能先求偏微分方程的通解然后再考虑定解条件，必须同时考虑偏微分方程和定解条件以进行求解。

## 齐次方程

用达朗贝尔公式求解具有很多局限性，更普遍的解法是将偏微分方程**分解为几个常微分方程**求解，也就是分离变数法。用分离变数法得到的定解问题的解一般是无穷级数，但在具体问题中级数里常常只有前若干项较为重要，后面的项迅速减小，从而可以一概略去。

### 分离变数法

齐次方程就是把微分项放到等号左边，等号右边等于 0。相当于**方程描述的区域**绳子上没有 driven force /热传导介质里没有热源/电磁场区域没有电荷......

此章研究有边界条件的问题，以下以两端有限长度的绳子为例。被启发用“驻波”（一般有分离变数的形式）解决问题，各点振动并不依次滞后，按同一方式随时间 $$t$$ 振动，振幅是坐标的函数，则解分解为**坐标的振幅**与**随 $$t$$ 振动**两项的乘积，带入泛定方程、边界条件和初始条件求解。

本节似乎研究的都是第一类和第二类齐次边界条件（如果边界条件非齐次，这里研究可以处理成具有一个方向上有齐次边界条件可以构成本征解的特殊情况）。将分离变量的试探解带入**泛定方程**，有关坐标的放在等式一边，有关时间的放在等式另一边。两边必须为常数才能相等（这个常数就是后面说的本征值）。首先，齐次**边界条件**给出坐标部分解的**本征值**和**本征函数**，也就是不同波长的驻波。然后，再将坐标的本征值带入时间分离出的方程中。坐标的解是三角函数，而时间解的部分代入已经求得的本征值也是三角函数（因数理方程类型而异）。对应本征值的时间空间函数相乘，得到绳子的**本征振动**方程，由于方程和边界条件都是齐次的，定解就是这些本征振动的线性叠加。时间部分的积分常数，由**初始条件**得出（$$t=0$$ 带入原式，以及带入导数式）。<span style="color: red;">边界条件给出坐标部分的本征值和本征函数。</span>

例题给出实例：1.高压电容器突起处电场强度大容易击穿，要尽量平整。2.长度为四分之一波长的传输线接在交流电源上，另一端开路，从交流电源一方看过来，这段传输线相当于一个短路元件。

【总结】：对于波动和输运问题，分离变数法可以总结为把所求的解展开为**傅里叶级数**：$$\displaystyle u(x,t)=\sum_nT_n(t)X_n(x)$$。齐次边界条件给出本征值 $$n$$ 和 $$X_n(x)$$ 的形式，代入泛定方程给出 $$T_n(t)$$ 的形式，初始条件给出这些本征振动项的系数。

### 施图姆-刘维尔本征值问题

考虑齐次方程——波动方程、输运方程、拉普拉斯方程。由于波动方程和输运方程有对时间的偏微分，把时间项分离出来（波动方程分离出平动和波动的时间项，输运方程分离出衰减的时间项）。两者分离出的空间部分都是**亥姆霍兹方程**（波动方程）。本节重点讨论的便是亥姆霍兹方程和拉普拉斯方程继续分离变数的结果。

对于不同形状的**边界条件**，用不同的坐标系，最常见的是**球坐标系**和**柱坐标系**。球坐标系拉普拉斯算符的表达式可在微积分学教科书中找到，如果找不到，见我的B站代表作[高等数学_场论初步_柱坐标、球坐标下梯度、散度、旋度](https://www.bilibili.com/video/BV137411t7oY?spm_id_from=333.999.0.0)。

![](/images/blog/PDE_Separating.jpg)

问题：我们得到了一些难以处理的**线性二阶常微分方程** $$\displaystyle \frac{d^2w}{dz^2}+p(z)\frac{dw}{dz}+q(z)w=0\quad (a\leq x\leq b)$$，如连带勒让德方程、勒让德方程、贝塞尔方程、球贝塞尔方程等，如何求解？i.e. $$l$$ 阶勒让德方程里的 $$l$$ 怎么来的？怎么解释要取整数？

**级数解法**：在某个任选点 $$z_0$$ 的邻域上，把待求的解表为系数待定的级数，代入方程逐个确定系数。试着求解一些例子，级数解的系数一般是一个递推关系，级数解有无穷多项。但是，为满足解有意义，级数解需要满足一些条件，对方程里的参数取值就有了要求。i.e. 为使 $$l$$ 阶勒让德方程在 $$x=±1$$ 也收敛（构成勒让德方程的**自然边界条件**），需要无穷级数退化为多项式，如果 **$$l$$ 取整数**，则可以退化成多项式。

如果 $$p(z)$$ 和 $$q(z)$$ 在 $$z_0$$ 的邻域中是解析的：常点邻域上的级数解法举例：求解勒让德方程。

如果 $$z_0$$ 是 $$p(z)$$ 和 $$q(z)$$ 的奇点：正则奇点邻域上的级数解法举例：求解贝塞尔方程。早在[复变函数-洛朗级数展开](https://shi200005.github.io/2022/02/15/Complex-Functions/#%E6%B4%9B%E6%9C%97%E7%BA%A7%E6%95%B0%E5%B1%95%E5%BC%80)的例子中，梁老师就展示了在 $$z_0=0$$ 的邻域上将 $$\displaystyle e^{\frac{1}{2}x(z-\frac{1}{z})}$$ 展开，结果得到 $$\displaystyle e^{\frac{1}{2}x(z-\frac{1}{z})}=\sum_{m=-\infty}^{\infty}J_m(x)z^m$$，其中 $$J_m(x)$$ 是 $$m$$ 阶贝塞尔函数。抱歉，我现在能联系到的就是这玩意是在奇点邻域上展开的，所以用洛朗级数展开。至于为啥能展成贝塞尔函数，还没想明白。

满足边界条件（不论是强行提出的，还是自然边界条件）的非零解往往不存在，除非方程的参数取某些特定值，这些特定值叫做**本征值**，相应的非零解叫做**本征函数**，求本征值和本征函数的问题叫做**本征值问题**。常见的本征值问题都归结为**施图姆-刘维尔本征值问题**。如果没有边界条件（无界空间），本征值怎么办？见下面**傅里叶变换法**。

【UPDATE】看到此处，我感到十分蒙蔽。我知道这些方程都是线性二阶常微分方程，但是这个形式的施图姆-刘维尔问题有什么优良品德？为什么有？我们可以看看这篇，引入了**自伴算符**的概念。[[顾樵 数学物理方法] Chap.9 施图姆-刘维尔理论；若干特殊方程的导出；二阶ODE级数解法基础](https://zhuanlan.zhihu.com/p/313031234)。这篇我是打算看的，但现在还没看。我猜测我们这里处理的都是施图姆-刘维尔问题，来源于微分方程都是从系统的守恒律里导出的。

### 傅里叶变换法

>  用分离变数法求解**有界空间**的定解问题时，所得到的本征值是**分立**的，所求的解可表为对分立本征值求和得到**傅里叶级数**。对于**无界空间**，用分离变数法求解定解问题时，所得到的本征谱一般是**连续**的，所求的解可表为对连续本征值求积分的**傅里叶积分**。因此，对于无界空间的定解问题，傅里叶变换是一种很适用的求解方法。

例：点源（初始条件为 $$\delta$$ 函数）的自由扩散问题，求解[扩散方程](https://shi200005.github.io/2022/02/24/Thermodynamics/#%E8%BE%93%E8%BF%90%E7%8E%B0%E8%B1%A1)，参见 [Diffusion](https://shi200005.github.io/download_file/PDE_Diffusion.pdf)。

## 球函数

好，接下来就让我们求解又长又臭的球函数和柱函数的定解问题。把费解的多项式代入边界条件暴力求展开系数之前（为啥能展开？请见下文**正交关系与模**），我们首先要参考**对称性**和舍弃**发散项**，简化我们考虑的多项式族。

球坐标系中分离出与 $$z$$ 轴夹角 $$\theta$$ 满足的方程，为**连带勒让德方程** $$\displaystyle (1-x^2)\frac{d^2\Theta}{dx^2}-2x\frac{d\Theta}{dx}+[l(l+1)-\frac{m^2}{1-x^2}]\Theta=0$$，其中 $$x=\cos\theta$$.

### 轴对称球函数 - 勒让德函数

<span style="color: red;">本征值：$l(l+1)$，本征函数：**勒让德函数**。</span>

这是最对称最简单的情况。如果边界条件是轴对称的，也就是与坐标投影在 $$xOy$$ 平面上与 $$x$$ 正半轴的夹角 $$\varphi$$ 无关，则上图中本征值 $$m=0$$，$$\Phi(\varphi)=\text{const}$$，此时连带勒让德方程退化成**勒让德方程**。轴对称球函数简化为 $$Y(\theta,\varphi)=P_l(x)$$，系数是约定俗成的，具体是啥书上都能查到，不如扔个图看看它们在图上长啥样。

 <img src="\images\blog\PDE_Legend.JPG" alt="PDE_Legend" width="500px;" />

**勒让德多项式的微分和积分表示如果遇到我再写**

例：[均匀介质球](https://shi200005.github.io/download_file/PDE_Electric.pdf)。重要结论：**介质球内部的极化场是均匀的**。这里，定解问题的泛定方程和边界条件由[电磁学](https://shi200005.github.io/2021/11/20/Electromagnetism/)相关知识给出，但是当时还没学数学物理方法这个又难又强的数学工具，故只能用长篇逻辑论证（应该在千题解里有，等我找到更新），现在就可以安心求解了。

例：在点电荷的电场中放置接地导体球，**就导体球外的静电场而论**，好像不存在导体球，而存在一个特定位置特定电量的点电荷。这就是**电像法**。详见梁老师 10.1 (七) 母函数 例6。有了勒让德方程，我们就不需要像大二电磁学那样整一堆逻辑论述了，暴力设坐标系暴力算就行。

**勒让德多项式的递推公式如果遇到我再写** 这玩意有点像把勒让德多项式当成分布函数用 generating functions 计算一阶矩

### 连带勒让德函数

不轴对称咋办？好办。<span style="color: red;">本征值：$l(l+1)$，本征函数：**连带勒让德函数**。</span>其中 $$m=0,1,2,...,l$$.

观察**连带勒让德方程**，不小心发现通过数学变换，可以和勒让德方程逐项求导 $$m$$ 的结果联系。$$P_l^m(x)=(1-x^2)P_l^{[m]}(x)$$。

**勒让德多项式的微分（罗德里格斯公式）和积分表示（施列夫利积分）如果遇到我再写**（我本科对这玩意的名字一点印象都没有，当然现在也没有）

### 一般的球函数

实数形式：$$Y_l^m(\theta,\varphi)=P_l^m(\cos\theta)\begin{Bmatrix}\sin(m\varphi)\\ \cos(m\varphi)\end{Bmatrix}$$, $$\begin{pmatrix}m=0,1,2,...,l\\l=0,1,2,3,...\end{pmatrix}$$.

复数形式：$$Y_l^m(\theta,\varphi)=P_l^{\vert m\vert}e^{im\varphi}$$, $$\begin{pmatrix}m=-l,-l+1,...,0,1,...,l\\l=0,1,2,3,...\end{pmatrix}$$.

线性独立的 $$l$$ 阶球函数共有 $$2l+1$$ 个。

应用：**偶极子、四极子、多极子电场中的电势**。其中偶极子问题涉及的数学很初等，在[电磁学](https://shi200005.github.io/2022/03/29/Electromagnetism/)已经是常规知识点，四极子、多极子则在**电动力学**（Sorry 我没写）涉及。重要推论：在区域 $$T$$ 中分布着电荷，对区域外远处的电场来说，区域 $$T$$ 里的电荷可以用一系列的多极子代替。

加法公式：intuition 是“在坐标系旋转时，球函数方程不变”。一个应用见[量子力学]()。

## 柱函数

柱坐标系中拉普拉斯方程分离出与极轴距离 $$\rho$$ 满足的方程 $$\displaystyle \frac{d^2R}{d\rho^2}+\frac{1}{\rho}\frac{dR}{d\rho}+(\mu-\frac{m^2}{\rho^2})R=0$$，按照

- $$\rho=0$$：退化为欧拉方程；
- $$\rho>0$$：做代换 $$x=\sqrt{\mu}\rho$$ 得到 **$$m$$ 阶贝塞尔方程** $$\displaystyle x^2\frac{d^2R}{dx^2}+x\frac{dR}{dx}+(x^2-m^2)R=0$$（此时 $$Z(z)$$ 解单调，$$R(\rho)$$ 解振荡）；
- $$\rho<0$$：记 $$\nu^2=-\mu$$，做代换 $$x=\nu\rho$$ 得到 **$$m$$ 阶虚宗量贝塞尔方程** $$\displaystyle x^2\frac{d^2R}{dx^2}+x\frac{dR}{dx}-(x^2+m^2)R=0$$（此时 $$Z(z)$$ 解振荡，$$R(\rho)$$ 解单调）。

球坐标系中亥姆霍兹方程分离出与远点距离 $$r$$ 满足的方程 $$\displaystyle r^2\frac{d^2R}{dr^2}+2r\frac{dR}{dr}+[k^2r^2-l(l+1)]R=0$$，可以化为 $$\displaystyle x\frac{d^2y}{dx^2}+x\frac{dy}{dx}+[x^2-(l+\frac{1}{2})^2]y=0$$。

### 贝塞尔函数

拉普拉斯方程柱侧有齐次边界条件问题（实心：贝塞尔函数、空心：加上诺伊曼函数）、波发射问题（汉克尔函数）。

方程能解出来一些多项式，例如 **$$\nu$$ 阶贝塞尔函数** $$J_\nu(x)$$ （第一类柱函数，形式看前面例题懒得打，**驻波**），**$$\nu$$ 阶诺伊曼函数** $$\displaystyle N_\nu(x)=\frac{J_\nu(x)\cos(\nu\pi)-J_{-\nu}(x)}{\sin(\nu\pi)}$$（第二类柱函数，**驻波**），第一种和第二种**汉克尔函数** $$H_\nu^{(1,2)}(x)=J_\nu(x)±iN_\nu(x)$$（第三类柱函数，$$H_\nu^{(1)}$$ 是**发散波**，$$H_\nu^{(2)}$$ 是**汇聚波**）。 

**递推公式没印象**

### 虚宗量贝塞尔函数

虚总量贝塞尔函数 $$I_\nu(x)$$、虚宗量汉克尔函数 $$K_\nu(x)$$。

### 球贝塞尔函数

球贝塞尔函数 $$j_l(x)=\displaystyle\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x)$$,  $$j_{-l}(x)$$、球诺伊曼函数 $$n_l(x)$$、球汉克尔函数 $$h_l^{(1,2)}(x)$$

研究波（声波、电磁波、量子力学的波函数）的散射问题，常常需要把平面波展开为球面波的叠加，公式查书。

## 非齐次方程

处理齐次边界条件。对于非齐次边界条件，要么是转化为齐次边界条件，要么是特殊情况可以抖机灵，目前还没遇到过。

### 振动方程和输运方程

#### 傅里叶级数法

和齐次情况相似，把所求的解展开为**傅里叶级数**：$$\displaystyle u(x,t)=\sum_nT_n(t)X_n(x)$$。本征值的本征振动方程是齐次情况中 $$T_n(x)$$ 的形式比较简单，但对应本征振动方程是非齐次情况可能使部分 $$T_n(x)$$ 的形式变得复杂，有时需要使用**拉普拉斯变换**求解。例：[复变函数-拉普拉斯变换及其应用](https://shi200005.github.io/download_file/Complex_Functions_Laplace.pdf)。

#### 格林函数法

又称**点源影响函数**，代表一个点源在一定的边界条件和（或）初始条件下所产生的场。

处理受迫振动或有源输运的含时 PDE。需要注意格林函数的对称性变为 $$G(\vec x,t;\vec x_0,t_0)=G(\vec x_0,-t_0;\vec r,-t)$$。输运问题可以用**冲量定理法**求解格林函数。冲量定理法的物理思想：把持续作用力看成许许多多前后相继的“瞬时”力，把持续作用引起的振动看成所有“瞬时”力引起的振动的叠加，不适用于与时间无关的问题，比如**泊松方程**。

例：求解 Damped Harmonic Oscillator，详见[(En) Linear Response](https://shi200005.github.io/2024/11/28/Linear-Response/)。

### 泊松方程

#### 特解法

无源的稳定场方程是**拉普拉斯方程**，有源的稳定场是**泊松方程**。也是懒得写。拆解成一个特解和一个拉普拉斯方程即可。拉普拉斯方程的求解参见齐次方程的分离变数法。

#### 格林函数法

实质：通过格林定理，把边值问题转化为求相应的另一个看似简单的边值问题的求解——格林函数。

求解


$$
\text{微分方程：泊松方程}\\
\nabla^2u=f(\vec x),\quad(\vec x\in T)\\
\text{边界条件}\\
\ [\alpha\frac{\partial u}{\partial n}+\beta u]_{\Sigma}=\varphi(M)
$$


在场论中，常常需要区分**场点** $$\vec x$$ 和**源点** $$\vec x'$$ 。定义算符对场点微分 $$\nabla=\vec e_i\displaystyle\frac{\partial}{\partial x_i}$$，对源点微分 $$\nabla'=\vec e_i\displaystyle\frac{\partial}{\partial x_i'}$$，具体关于**相对位矢** $$\vec r=\vec x-\vec x'$$ 的运算律见电动力学课件。  

考虑点源产生的场。由[微积分 - 矢量分析](https://shi200005.github.io/2021/09/30/Calculus/#%E9%AB%98%E6%96%AF%E5%85%AC%E5%BC%8F%E6%A0%BC%E6%9E%97%E5%85%AC%E5%BC%8F%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F)结论，$$\nabla^2v(\vec x,\vec x_0)=\delta(\vec x-\vec x_0)$$。矢量分析一顿操作猛如虎，$$u(\vec x_0)=\displaystyle\int_Tv(\vec x,\vec x_0)f(\vec x)dV-\displaystyle\int_{\Sigma}[v(\vec x,\vec x_0)\displaystyle\frac{\partial u(\vec x)}{\partial n}-u(\vec x)\displaystyle\frac{\partial v(\vec x,\vec x_0)}{\partial n}]dS$$，接下来，就可以按不同边界条件转化为对格林函数 $$G(\vec x,\vec x_0)$$ 的求解。

例：第一类边值条件 $$u=\varphi(M)$$ 的求解。

- 记满足 $$v\vert_\Sigma=0$$ 的 $$v$$ 为 $$G(\vec x,\vec x_0)$$，根据边界条件化简 $$u(\vec x_0)$$，再根据调和函数性质得到格林函数对称性（证明在教材上），$$G(\vec x_1.\vec x_2)=G(\vec x_2.\vec x_1)$$，则 $$u(\vec x)=\displaystyle\int_TG(\vec x,\vec x_0)f(\vec x_0)dV_0-\displaystyle\int_{\Sigma}\varphi(\vec x_0)\displaystyle\frac{\partial G(\vec x,\vec x_0)}{\partial n_0}dS_0$$.

  例：[电磁学](https://shi200005.github.io/2022/03/29/Electromagnetism/)中含有导体空间的静电场求解。$$G$$ 由特定边界条件确定。











